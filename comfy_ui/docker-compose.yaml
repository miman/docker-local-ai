version: '3.8'

services:
  comfy-ui:
    # The 'build' command is a simple string, not a map.
    build: ./ComfyUI
    container_name: comfy-ui
    ports:
      - "4515:8188"
    volumes:
      - ~/comfyui/models:/app/models
      - ~/comfyui/custom_nodes:/app/custom_nodes
      - ~/comfyui/input:/app/input
      - ~/comfyui/output:/app/output
    runtime: nvidia
    environment:
      - NVIDIA_VISIBLE_DEVICES=all
